{
  "01_find_callers": {
    "description": "Who calls validate_token?",
    "query": "refs validate_token --kind calls",
    "expected": [
      {"source": "get_current_user", "file": "auth/service.rs"},
      {"source": "refresh_token", "file": "auth/tokens.rs"},
      {"source": "auth_middleware", "file": "auth/middleware.rs"}
    ]
  },
  "02_file_structure": {
    "description": "What's in auth/service.rs?",
    "query": "outline auth/service.rs",
    "expected": [
      {"name": "AuthProvider", "kind": "class"},
      {"name": "login", "kind": "method"},
      {"name": "logout", "kind": "method"},
      {"name": "get_current_user", "kind": "method"},
      {"name": "DefaultAuth", "kind": "class"},
      {"name": "new", "kind": "method"},
      {"name": "AdminAuth", "kind": "class"},
      {"name": "impersonate", "kind": "method"},
      {"name": "list_all_users", "kind": "method"}
    ]
  },
  "03_refactor_impact": {
    "description": "Impact of changing AuthProvider",
    "query": "impact AuthProvider --depth 3",
    "expected_refs": [
      "DefaultAuth",
      "auth/mod.rs",
      "routes/auth.rs"
    ]
  },
  "04_class_hierarchy": {
    "description": "Trait impls for AuthProvider",
    "query": "hierarchy AuthProvider",
    "expected": [
      {"child": "DefaultAuth", "parent": "AuthProvider"}
    ]
  },
  "05_trace_call_chain": {
    "description": "Trace login_handler call chain",
    "query_sequence": [
      "callees login_handler",
      "callees login",
      "callees generate_token"
    ],
    "expected_chain": [
      {"caller": "login_handler", "callee": "Config::load"},
      {"caller": "login_handler", "callee": "DefaultAuth::new"},
      {"caller": "login_handler", "callee": "auth.login"},
      {"caller": "login", "callee": "generate_token"},
      {"caller": "login", "callee": "User::find_by_email"},
      {"caller": "generate_token", "callee": "Session::create"}
    ]
  },
  "06_file_deps": {
    "description": "What does routes/auth.rs import?",
    "query": "deps routes/auth.rs",
    "expected": [
      "auth_middleware",
      "extract_token",
      "AuthProvider",
      "DefaultAuth",
      "refresh_token",
      "Config",
      "Request",
      "Response"
    ]
  },
  "07_type_references": {
    "description": "Type references to User in Rust (function signatures)",
    "query": "refs User --kind references",
    "expected": [
      {"source": "generate_token", "file": "auth/tokens.rs"},
      {"source": "validate_token", "file": "auth/tokens.rs"},
      {"source": "revoke_all_tokens", "file": "auth/tokens.rs"},
      {"source": "get_current_user", "file": "auth/service.rs"},
      {"source": "list_all_users", "file": "auth/service.rs"},
      {"source": "auth_middleware", "file": "auth/middleware.rs"},
      {"source": "admin_middleware", "file": "auth/middleware.rs"},
      {"source": "create", "file": "models/session.rs"},
      {"source": "find_all_by_user", "file": "models/session.rs"}
    ]
  }
}
